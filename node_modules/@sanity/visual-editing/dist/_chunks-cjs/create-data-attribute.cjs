"use strict";var e=require("@sanity/comlink"),t=require("@sanity/client/csm"),n=require("./transformSanityNodeData.cjs");const a={"handshake/syn":e.MSG_HANDSHAKE_SYN,"handshake/syn-ack":e.MSG_HANDSHAKE_SYN_ACK,"handshake/ack":e.MSG_HANDSHAKE_ACK,"channel/response":e.MSG_RESPONSE,"channel/heartbeat":e.MSG_HEARTBEAT,"channel/disconnect":e.MSG_DISCONNECT,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},o={[e.MSG_HANDSHAKE_SYN]:"handshake/syn",[e.MSG_HANDSHAKE_SYN_ACK]:"handshake/syn-ack",[e.MSG_HANDSHAKE_ACK]:"handshake/ack",[e.MSG_RESPONSE]:"channel/response",[e.MSG_HEARTBEAT]:"channel/heartbeat",[e.MSG_DISCONNECT]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},i=t=>{const{data:n}=t;return n&&"object"==typeof n&&"domain"in n&&"type"in n&&"from"in n&&"to"in n&&("sanity/channels"===n.domain&&(n.domain=e.DOMAIN),"overlays"===n.to&&(n.to="visual-editing"),"overlays"===n.from&&(n.from="visual-editing"),n.channelId=n.connectionId,delete n.connectionId,n.type=a[n.type]??n.type),t},r=({context:t},n)=>{const{sources:a,targetOrigin:i}=t,r=(t=>{const{channelId:n,...a}=t,i={...a,connectionId:n};return i.domain===e.DOMAIN&&(i.domain="sanity/channels"),"visual-editing"===i.to&&(i.to="overlays"),"visual-editing"===i.from&&(i.from="overlays"),i.type=o[i.type]??i.type,"channel/response"===i.type&&i.responseTo&&!i.data&&(i.data={responseTo:i.responseTo}),("handshake/syn"===i.type||"handshake/syn-ack"===i.type||"handshake/ack"===i.type)&&(i.data={id:i.connectionId}),i})(n.message);a.forEach((e=>{e.postMessage(r,{targetOrigin:i})}))};const s={alt:"altKey",ctrl:"ctrlKey",mod:typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};exports.a=function(e,t){return e.every((e=>s[e]?t[s[e]]:t.key===e.toUpperCase()))},exports.b=()=>({listen:e.createListenLogic(i),requestMachine:e.createRequestMachine().provide({actions:{"send message":r}})}),exports.c=function e(a){function o(e){return e?"string"==typeof e?t.studioPath.fromString(e):e:[]}function i(e){if(!e.id)throw new Error("`id` is required to create a data attribute");if(!e.type)throw new Error("`type` is required to create a data attribute");if(!e.path||!e.path.length)throw new Error("`path` is required to create a data attribute");const a={baseUrl:e.baseUrl||"/",workspace:e.workspace,tool:e.tool,type:e.type,id:e.id,path:"string"==typeof e.path?e.path:t.studioPath.toString(e.path)};return n.e(a)}const r=e=>i({...a,path:[...o(a.path),...o(e)]});return r.toString=function(){return i(a)},r.combine=function(t){return e({...a,...t})},r.scope=function(t){return e({...a,path:[...o(a.path),...o(t)]})},r},exports.i=function(e){return"Alt"===e.key};//# sourceMappingURL=create-data-attribute.cjs.map
