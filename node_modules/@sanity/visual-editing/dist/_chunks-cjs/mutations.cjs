"use strict";var t=require("react-compiler-runtime"),e=require("@sanity/mutate"),n=require("./transformSanityNodeData.cjs"),r=require("xstate"),o=require("react");function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=s(require("get-random-values-esm"));const u=/_key\s*==\s*['"](.*)['"]/,c=/^\d*:\d*$/;function f(t){return"number"==typeof t||"string"==typeof t&&/^\[\d+\]$/.test(t)}function a(t){return"string"==typeof t?u.test(t.trim()):"object"==typeof t&&"_key"in t}const p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/_key\s*==\s*['"](.*)['"]/;function y(t,e,n){const r="string"==typeof e?function(t){if("string"!=typeof t)throw new Error("Path is not a string");const e=t.match(p);if(!e)throw new Error("Invalid path string");return e.map(h)}(e):e;if(!Array.isArray(r))throw new Error("Path must be an array or a string");let o=t;for(let t=0;t<r.length;t++){const e=r[t];if(f(e)){if(!Array.isArray(o))return n;o=o[e]}if(a(e)){if(!Array.isArray(o))return n;o=o.find((t=>t._key===e._key))}if("string"==typeof e&&(o="object"==typeof o&&null!==o?o[e]:void 0),typeof o>"u")return n}return o}function h(t){return f(t)?function(t){return Number(t.replace(/[^\d]/g,""))}(t):a(t)?function(t){return{_key:t.match(d)[1]}}(t):function(t){if("string"==typeof t&&c.test(t))return!0;if(!Array.isArray(t)||2!==t.length)return!1;const[e,n]=t;return!("number"!=typeof e&&""!==e||"number"!=typeof n&&""!==n)}(t)?function(t){const[e,n]=t.split(":").map((t=>""===t?t:Number(t)));return[e,n]}(t):t}function l(t){return t.startsWith(n.D)}function m(t){return l(t)?t:n.D+t}function g(t){return l(t)?t.slice(n.D.length):t}const b=r.createEmptyActor();let w=b;const x=new Set;function k(t){return t===b}function S(){return o.useSyncExternalStore(I,E,_)}function _(){return b}function E(){return w}function I(t){return x.add(t),()=>x.delete(t)}function D(t,e){let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>{t.apply(t,r)}),e)}}function A(t,e){const n=window.self!==window.top||window.opener;if(k(e)||!n)throw new Error("The `useDocuments` hook cannot be used in this context");const r=m(t),o=g(t),s=e.getSnapshot().context?.documents,i=s?.[r],u=s?.[o],c=i||u;if(!c)throw new Error(`Document "${t}" not found`);const f=i.getSnapshot().context?.local||u.getSnapshot().context?.local,a=new Promise((t=>{if(f)t(f);else{const e=c.on("ready",(n=>{const{snapshot:r}=n;t(r||null),e.unsubscribe()}))}}));return{draftDoc:i,draftId:r,getSnapshot:()=>a,publishedDoc:u,publishedId:o,get snapshot(){if(!f)throw new Error(`Snapshot for document "${t}" not found`);return f}}}function v(t,e){return()=>{const{draftDoc:n}=A(t,e);n.send({type:"submit"})}}function j(t,e){return n=>{const{snapshot:r}=A(t,e);return n?y(r,n):r}}function O(t,e){const{getSnapshot:n}=A(t,e);return n}function q(t,n){return async(r,o)=>{const s=A(t,n),{draftDoc:i,draftId:u,getSnapshot:c,publishedId:f}=s,{commit:a=!0}=o||{},p=await("function"==typeof r?r({draftId:u,publishedId:f,get snapshot(){return s.snapshot},getSnapshot:c}):r),d=await c();if(!d)throw new Error(`Snapshot for document "${t}" not found`);i.send({type:"mutate",mutations:[e.createIfNotExists({...d,_id:u}),e.patch(u,p)]}),a&&("object"==typeof a&&"debounce"in a?D((()=>i.send({type:"submit"})),a.debounce)():i.send({type:"submit"}))}}const $=(()=>{let t;return()=>{if(t)return t;t=[];for(let e=0;e<256;++e)t[e]=(e+256).toString(16).slice(1);return t}})();function N(t){const e=$();return function(t=16){const e=new Uint8Array(t);return i.default(e),e}(t).reduce(((t,n)=>t+e[n]),"").slice(0,t)}function P(t){const e="string"==typeof t?t:t.path,n=e.lastIndexOf("."),r=e.substring(n+1,e.length);if(!r.indexOf("["))throw new Error("Invalid path: not an array");const o=e.lastIndexOf("["),s=e.substring(0,o);let i,u;if(r.includes("_key")){const t=r.indexOf('"')+1,e=r.indexOf('"',t);i=r.substring(t,e),u=!0}else{const t=r.indexOf("[")+1,e=r.indexOf("]",t);i=r.substring(t,e),u=!1}if(!s||!i)throw new Error("Invalid path");return{path:s,key:i,hasExplicitKey:u}}exports.a=function(){const e=t.c(7),n=S();let r;e[0]!==n?(r=t=>({id:t,commit:v(t,n),get:j(t,n),getSnapshot:O(t,n),patch:q(t,n)}),e[0]=n,e[1]=r):r=e[1];const o=r;let s;e[2]!==n?(s=(t,e,r)=>{const{draftDoc:o}=A(t,n),{commit:s}=r||{},i=void 0===s||s;o.send({type:"mutate",mutations:e}),i&&("object"==typeof i&&"debounce"in i?D((()=>o.send({type:"submit"})),i.debounce)():o.send({type:"submit"}))},e[2]=n,e[3]=s):s=e[3];const i=s;let u;return e[4]!==o||e[5]!==i?(u={getDocument:o,mutateDocument:i},e[4]=o,e[5]=i,e[6]=u):u=e[6],u},exports.b=P,exports.c=function(t,n,r){const{path:o,key:s}=P(t),i=N();return[e.at(o,e.insert([{_type:n,_key:i}],r,{_key:s}))]},exports.d=y,exports.e=async function(t,n,r){if(!t.type)throw new Error("Node type is missing");const{path:o,key:s}=P(t),i=await n.getSnapshot(),u=y(i,o),c=y(i,t.path),f=u.findIndex((t=>t._key===s));let a=-1,p="before";if("first"===r){if(0===f)return[];a=0,p="before"}else if("last"===r){if(f===u.length-1)return[];a=-1,p="after"}else if("next"===r){if(f===u.length-1)return[];a=f,p="after"}else if("previous"===r){if(0===f)return[];a=f-1,p="before"}return[e.at(o,e.truncate(f,f+1)),e.at(o,e.insert(c,p,a))]},exports.f=function(t,n){const{path:r,key:o}=P(t),s=y(n,r).findIndex((t=>t._key===o));return[e.at(r,e.truncate(s,s+1))]},exports.g=g,exports.h=function(t,n,r="after"){const{path:o,key:s}=P(t),i={...y(n,t.path),_key:N()};return[e.at(o,e.insert(i,r,{_key:s}))]},exports.i=k,exports.j=function(){let t;return t=!k(S()),t},exports.k=m,exports.s=function(t){w=t;for(const t of x)t()},exports.u=S;//# sourceMappingURL=mutations.cjs.map
