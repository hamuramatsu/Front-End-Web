"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_chunks-cjs/SharedStateContext.cjs"),t=require("./_chunks-cjs/enableVisualEditing.cjs"),r=require("./_chunks-cjs/mutations.cjs"),s=require("react-compiler-runtime"),n=require("react"),u=require("use-effect-event"),i=require("./_chunks-cjs/create-data-attribute.cjs");exports.createOverlayController=e.c,exports.enableVisualEditing=t.e,exports.getArrayItemKeyAndParentPath=r.b,exports.useDocuments=r.a,exports.createDataAttribute=i.c,exports.useOptimistic=function(e,t){const i=s.c(16),[c,a]=n.useState(!0),[o,d]=n.useState(e),[l,f]=n.useState(null),[p,S]=n.useState(e),h=r.u();let b;i[0]!==t?(b=(e,s)=>(Array.isArray(t)?t:[t]).reduce(((t,s)=>s(t,{document:e.document,id:r.g(e.id),originalId:e.id,type:e.type})),s),i[0]=t,i[1]=b):b=i[1];const m=u.useEffectEvent(b);let x;i[2]!==e?(x=()=>S(e),i[2]=e,i[3]=x):x=i[3];const y=u.useEffectEvent(x);let E,g,j,v;return i[4]!==h||i[5]!==m||i[6]!==y?(E=()=>{if(r.i(h))return;let e;const t=h.on("rebased.local",(t=>{const s={document:t.document,id:t.id,originalId:r.g(t.id),type:"mutate"};d((e=>m(s,e))),f(s),y(),a(!1),clearTimeout(e)})),s=h.on("pristine",(()=>{e=setTimeout((()=>{n.startTransition((()=>a(!0)))}),15e3)}));return()=>{t.unsubscribe(),s.unsubscribe()}},g=[h,m,y],i[4]=h,i[5]=m,i[6]=y,i[7]=E,i[8]=g):(E=i[7],g=i[8]),n.useEffect(E,g),i[9]!==l||i[10]!==p||i[11]!==e||i[12]!==c||i[13]!==m?(j=()=>{if(!c){if(!l)throw new Error("No last event found when syncing passthrough");p!==e&&n.startTransition((()=>{d(m(l,e)),S(e)}))}},v=[l,p,e,c,m],i[9]=l,i[10]=p,i[11]=e,i[12]=c,i[13]=m,i[14]=j,i[15]=v):(j=i[14],v=i[15]),n.useEffect(j,v),c?e:o},exports.useSharedState=function(t){const r=s.c(3),u=n.useContext(e.S);if(!u)throw new Error("useSharedState must be used within a SharedStateProvider");const{store:i}=u;let c;return r[0]!==t||r[1]!==i?(c=()=>i.getState()[t],r[0]=t,r[1]=i,r[2]=c):c=r[2],n.useSyncExternalStore(i.subscribe,c)};//# sourceMappingURL=index.cjs.map
